# 更新 README.md 的详细计划

**目标：** 创建一份清晰、准确、全面的用户指南，帮助用户理解和有效使用“教师薪资管理系统”的各项功能。指南将添加到现有 `README.md` 文件中“规划文档”部分的下方。

**主要章节和内容点：**

1.  **引言 (Introduction)**
    *   简要介绍系统的用途：一个用于管理教师薪资、排班和相关数据的工具。
    *   提及系统的主要优势：简化排班流程、自动化薪资计算、集中管理教师和课程数据。
    *   说明本指南的目的。

2.  **重要提示 (Important Notes)**
    *   **数据存储**: 明确指出所有数据（教师信息、课程、排班、薪资单等）都存储在用户的**本地浏览器 `localStorage`** 中。
    *   **数据同步与备份**: 提醒用户数据不会在不同设备或浏览器间自动同步，建议用户了解这一点（如果系统未来支持导出/导入功能，此处可更新）。
    *   **浏览器兼容性**: 建议使用现代主流浏览器（如 Chrome, Firefox, Edge）以获得最佳体验（虽然代码中未明确指定，但这是良好实践）。

3.  **快速上手 (Quick Start / Initial Setup)**
    *   **访问系统**: 说明如何打开 `index.html` 文件来启动应用。
    *   **首次使用**:
        *   解释系统在首次加载时会自动初始化一批**默认数据**：
            *   **课程/时段类型**: 基于提供的Excel表头（如“早自修”、“第1节”等），包含默认时长和薪资乘数。
            *   **教师列表**: 基于提供的Excel教师名单，包含默认时薪。
        *   告知用户这些默认数据是基础，可以在“系统设置”中进行修改、删除或添加更多。
    *   **界面概览**: 简要介绍主要的导航区域（系统设置、排班与工时、薪资计算）及其用途。

4.  **主要功能用法 (Main Feature Usage)**

    *   **A. 系统设置 (System Settings)**
        *   **导航**: 如何进入“系统设置”模块。
        *   **1. 课程/时段管理 (Managing Course/Timeslot Types)**
            *   目的：定义教学时段及其属性，用于排班和薪资计算。
            *   操作：
                *   查看现有课程/时段列表（名称、默认时长、薪资乘数）。
                *   添加新课程/时段：如何填写ID（自动生成）、名称、默认时长（分钟）、薪资乘数（例如1.0代表正常薪资，0.5代表半薪，0.0代表不计薪如午休）。
                *   编辑现有课程/时段。
                *   删除课程/时段。
            *   截图示意（如果可能，用Mermaid流程图或文本描述代替）：展示管理界面的布局。
        *   **2. 教师管理 (Managing Teachers)**
            *   目的：维护教师基本信息和默认排班。
            *   操作：
                *   查看教师列表（姓名、默认时薪）。
                *   添加新教师：如何填写ID（自动生成）、姓名、默认时薪。
                *   编辑教师信息。
                *   删除教师。
                *   **设置每周固定排课 (Setting Weekly Default Schedule)**:
                    *   解释此功能的重要性：为教师设定一周中固定的上课安排。
                    *   如何为选定教师，针对周日到周六的每一天，通过勾选相应的课程/时段来设定默认排班。
                    *   如何保存设置。
            *   截图示意。
        *   **3. 排班模板管理 (Managing Schedule Templates)**
            *   目的：创建可复用的排班模式，简化排班流程。
            *   操作：
                *   查看现有模板列表。
                *   添加新模板：如何命名模板，并为周日到周六的每一天选择课程/时段来构建模板。
                *   编辑现有模板。
                *   删除模板。
            *   截图示意。
        *   **4. 日历设置 (Calendar Settings)**
            *   提及此功能当前为“待开发”。

    *   **B. 排班与工时管理 (Scheduling and Work Hours Management)**
        *   **导航**: 如何进入“排班与工时”模块。
        *   **1. 查看月度排班 (Viewing Monthly Schedule)**
            *   如何选择年份、月份和教师来加载特定教师的月度排班表。
            *   解释排班表显示内容：
                *   日期和星期。
                *   每日的各个课程/时段。
                *   单元格中的标记含义：“默认✓”（来自教师的每周固定排班）、“✓”（实际安排的课程）、“代✓”（该教师代别人的课或自己的课被别人代）、“假”（教师请假）。
        *   **2. 编辑排班 (Editing Schedule)**
            *   如何通过点击排班表中的具体单元格（某个教师在某天某个时段的安排）来进行编辑。
            *   编辑选项：
                *   **添加/修改课程**: 将默认排班应用为实际排班，或直接添加新的课程安排。
                *   **标记为代班**: 如果是代班，如何选择实际代班的教师。
                *   **删除排班**: 清除该单元格的排班记录。
            *   如何保存更改。
        *   **3. 请假管理 (Managing Leave Records)**
            *   目的：记录教师的请假情况，会自动影响排班和薪资。
            *   操作：
                *   查看现有请假记录列表（教师、请假类型、起止日期、事由）。
                *   添加新请假记录：选择教师、请假类型（事假、病假等）、开始日期、结束日期、填写事由。
                *   编辑现有请假记录。
                *   删除请假记录。
        *   截图示意：月度排班表示例、编辑单元格弹窗示例、请假管理界面示例。

    *   **C. 薪资计算与审批 (Payroll Calculation and Approval)**
        *   **导航**: 如何进入“薪资计算”模块。
        *   **1. 生成薪资签到表 (Generating Payroll Sign-in Sheet)**
            *   如何选择年份、月份和教师来生成该教师当月的薪资签到表。
            *   解释签到表结构和内容（基于`ui.js`中的`calculateAndDisplayPayroll`函数）：
                *   表头信息（学年、学期、月份、教师姓名）。
                *   每日签到：日期、星期。
                *   各课程/时段的有效工时（已乘以薪资乘数，请假则显示“请假”，被代班则显示代班教师）。
                *   每日各时段工时小计。
                *   月度汇总：总有效分钟数、总有效小时数、教师时薪、本月工时薪资（小时数 * 时薪）。
        *   **2. 薪资调整与备注 (Payroll Adjustments and Notes)**
            *   如何在签到表下方找到“调整金额”输入框，输入正数或负数进行调整。
            *   如何在“备注”框中填写调整原因或其他说明。
            *   “最终薪资”会自动根据“本月工时薪资”和“调整金额”计算。
        *   **3. 保存与确认薪资单 (Saving and Confirming Payslip)**
            *   **保存**: 点击“保存”按钮可以将当前的薪资单（包括调整和备注）的状态保存下来，后续仍可修改。
            *   **确认**: 点击“确认”按钮。
                *   **重要**: 提醒用户一旦确认，该薪资单将变为**不可修改**状态。
                *   状态会显示为“已确认”。
        *   **4. 薪资报表 (Payroll Reports)**
            *   提及此功能当前为“待开发”。
        *   截图示意：薪资签到表示例。

5.  **数据管理 (Data Management)**
    *   重申数据存储在 `localStorage`。
    *   **数据结构简述 (可选，偏技术)**: 简要说明各类数据（教师、时段、排班等）是如何组织存储的（例如，教师是一个对象数组，月度排班是一个以年月为键、排班条目数组为值的对象）。这有助于有技术背景的用户理解。
    *   **清除数据/重置系统 (Clearing Data / Resetting System)**:
        *   说明如何通过浏览器开发者工具手动清除 `localStorage` 中的特定项或所有项来实现数据清除或系统重置（恢复到首次使用的默认数据状态）。
        *   **警告**: 强调这将删除所有用户输入的数据，操作前务必谨慎。

6.  **系统特性总结 (System Features Summary)**
    *   列点总结系统的核心功能和优势。
    *   例如：基于Web、本地存储、灵活的时段与薪资乘数定义、教师每周默认排班、交互式月度排班编辑、详细的薪资计算与调整、薪资单确认流程等。

7.  **故障排除/常见问题 (Troubleshooting / FAQ) (可选，初期可省略)**
    *   例如：数据未保存怎么办？如何清除缓存？

8.  **未来展望 (Future Enhancements) (可选)**
    *   提及已知的“待开发”功能（日历设置、薪资报表）。
    *   可以简要提及其他可能的改进方向，如数据导入/导出、用户账户系统等（如果适用）。

**计划图示 (Mermaid Diagram):**

```mermaid
graph TD
    A[用户启动应用 index.html] --> B{localStorage中是否有数据?};
    B -- 是 --> C[加载现有数据];
    B -- 否 --> D[initializeDefaultData(): 创建默认时段和教师];
    D --> C;
    C --> E[显示主界面: 默认进入系统设置];

    E --> F[导航栏: 系统设置 | 排班工时 | 薪资计算];
    F -- 点击 系统设置 --> G[系统设置模块];
    G --> G1[管理课程/时段];
    G --> G2[管理教师 (含每周固定排班)];
    G --> G3[管理排班模板];

    F -- 点击 排班工时 --> H[排班与工时模块];
    H --> H1[查看/编辑月度排班];
    H --> H2[管理请假记录];

    F -- 点击 薪资计算 --> I[薪资计算模块];
    I --> I1[生成/查看薪资签到表];
    I --> I2[薪资调整与备注];
    I --> I3[保存/确认薪资单];

    G1 -- 数据读写 --> J[localStorage];
    G2 -- 数据读写 --> J;
    G3 -- 数据读写 --> J;
    H1 -- 数据读写 --> J;
    H2 -- 数据读写 --> J;
    I1 -- 数据读写 --> J;
    I2 -- 数据读写 --> J;
    I3 -- 数据读写 --> J;